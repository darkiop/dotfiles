#!/bin/bash

# Feature flags for dotfiles (opt-in overrides via local settings).
#
# Local overrides (gitignored):
#   ~/dotfiles/config/local_dotfiles_settings
#
# Example:
#   DOTFILES_ENABLE_FZF=false
#   DOTFILES_ENABLE_TMUX_AUTOSTART=false
#   DOTFILES_ENABLE_AUTOUPDATE=false

dotfiles_flag_enabled() {
	local var_name="$1"
	local value=""
	eval "value=\"\${${var_name}:-}\""
	case "${value}" in
	1 | true | TRUE | yes | YES | y | Y | on | ON) return 0 ;;
	0 | false | FALSE | no | NO | n | N | off | OFF | "") return 1 ;;
	*) return 1 ;;
	esac
}

if [[ -f "${HOME}/dotfiles/config/local_dotfiles_settings" ]]; then
	# shellcheck source=/dev/null
	source "${HOME}/dotfiles/config/local_dotfiles_settings"
fi

: "${DOTFILES_ENABLE_PROMPT:=true}"
: "${DOTFILES_ENABLE_BASH_COMPLETION:=true}"
: "${DOTFILES_ENABLE_FZF:=true}"
: "${DOTFILES_ENABLE_NAVI:=true}"
: "${DOTFILES_ENABLE_ALIASES:=true}"
: "${DOTFILES_ENABLE_SSH_PICKER:=true}"
: "${DOTFILES_ENABLE_GIT_FZF:=true}"
: "${DOTFILES_ENABLE_FZF_EXTRAS:=true}"
: "${DOTFILES_ENABLE_FZF_HISTORY_BINDINGS:=true}"
: "${DOTFILES_ENABLE_FZF_CDF_BINDING:=true}"
: "${DOTFILES_ENABLE_HELPERS:=true}"
: "${DOTFILES_ENABLE_FZF_TAB_COMPLETION:=true}"
: "${DOTFILES_ENABLE_EXTRACT_EXT:=true}"
: "${DOTFILES_ENABLE_OH_MY_ZSH:=false}"
: "${DOTFILES_ENABLE_MOTD:=false}"
: "${DOTFILES_ENABLE_MOTD_AUTO_RUN:=false}"
: "${DOTFILES_ENABLE_AUTOUPDATE:=true}"
: "${DOTFILES_ENABLE_TMUX_AUTOSTART:=true}"
: "${DOTFILES_ENABLE_SSH_TMUX_RENAME:=true}"
: "${DOTFILES_ENABLE_IOBROKER:=true}"

export DOTFILES_ENABLE_PROMPT
export DOTFILES_ENABLE_BASH_COMPLETION
export DOTFILES_ENABLE_FZF
export DOTFILES_ENABLE_NAVI
export DOTFILES_ENABLE_ALIASES
export DOTFILES_ENABLE_SSH_PICKER
export DOTFILES_ENABLE_GIT_FZF
export DOTFILES_ENABLE_FZF_EXTRAS
export DOTFILES_ENABLE_FZF_HISTORY_BINDINGS
export DOTFILES_ENABLE_FZF_CDF_BINDING
export DOTFILES_ENABLE_HELPERS
export DOTFILES_ENABLE_FZF_TAB_COMPLETION
export DOTFILES_ENABLE_EXTRACT_EXT
export DOTFILES_ENABLE_OH_MY_ZSH
export DOTFILES_ENABLE_MOTD
export DOTFILES_ENABLE_MOTD_AUTO_RUN
export DOTFILES_ENABLE_AUTOUPDATE
export DOTFILES_ENABLE_TMUX_AUTOSTART
export DOTFILES_ENABLE_SSH_TMUX_RENAME
export DOTFILES_ENABLE_IOBROKER
